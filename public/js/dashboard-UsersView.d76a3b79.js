"use strict";(self["webpackChunkclient_management"]=self["webpackChunkclient_management"]||[]).push([[735],{7474:function(e,s,t){t.r(s),t.d(s,{default:function(){return x}});var a=function(){var e=this,s=e._self._c;return s("dashboard-content",[s("div",{staticClass:"d-flex flex-wrap w-100 mb-3"},[s("BaseDropdownSelect",{staticClass:"mr-3 mb-3",attrs:{options:e.statusOptions,label:"Status",bordered:""},model:{value:e.filters.status,callback:function(s){e.$set(e.filters,"status",s)},expression:"filters.status"}}),s("b-btn",{directives:[{name:"b-modal",rawName:"v-b-modal.UserFormModal",modifiers:{UserFormModal:!0}}],staticClass:"align-self-end ml-lg-auto text-nowrap mb-3 font-weight-bold",attrs:{variant:"primary"}},[e._v("Add User")])],1),s("b-table",{attrs:{fields:e.fields,items:e.$store.state.dashboard.users.results,"per-page":e.perPage,"current-page":1,hover:"",outlined:"",borderless:"",responsive:"",stacked:"md","head-variant":"light","thead-class":"text-nowrap","table-class":"mb-2","show-empty":"",busy:e.isLoading},scopedSlots:e._u([{key:"cell(#)",fn:function({index:s}){return[e._v(" "+e._s(s+1)+" ")]}},{key:"cell(full_name)",fn:function({item:s}){return[e._v(" "+e._s(s.first_name+" "+s.last_name)+" ")]}},{key:"cell(created_at)",fn:function({value:t}){return[s("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip"}],attrs:{role:"button",title:new Date(t).toLocaleString()}},[e._v(e._s(e.$timeAgo.format(new Date(t))))])]}},{key:"cell(is_active)",fn:function({item:t}){return[s("b-form-checkbox",{attrs:{switch:""},on:{change:function(s){return e.changeStatus(s,t)}},model:{value:t.is_active,callback:function(s){e.$set(t,"is_active",s)},expression:"item.is_active"}})]}},{key:"cell(actions)",fn:function({item:t}){return[s("div",{staticClass:"d-flex align-items-center"},[s("a",{staticClass:"mr-3 text-success",attrs:{role:"button"},on:{click:function(s){return e.openEditModal(t)}}},[s("BIconPencilSquare",{attrs:{scale:"1.3"}})],1),s("a",{staticClass:"text-danger",attrs:{role:"button"},on:{click:function(s){return e.$refs.DeleteUserModal.open(t)}}},[s("BIconTrash",{attrs:{scale:"1.3"}})],1)])]}}])}),s("BasePagination",{attrs:{total:e.$store.state.dashboard.users.count,perPage:e.perPage},model:{value:e.page,callback:function(s){e.page=s},expression:"page"}}),s("UserFormModal"),s("DeleteModal",{ref:"DeleteUserModal",attrs:{field:"User"},on:{ok:e.deleteUser}})],1)},r=[],i=t(436),n=t(4749),o=t(581),l=t(1443),d=t(8752),u=function(){var e=this,s=e._self._c;return s("default-modal",{attrs:{id:"UserFormModal",isBusy:e.isBusy,title:e.formTitle,stayOpen:e.modalSettings.stayOpen,showStayOpenBtn:e.modalSettings.showStayOpenBtn},on:{ok:e.handleSave,hidden:e.resetForm,show:e.show,"update:stayOpen":function(s){return e.$set(e.modalSettings,"stayOpen",s)},"update:stay-open":function(s){return e.$set(e.modalSettings,"stayOpen",s)}}},[s("div",{staticClass:"user-form py-3"},[s("b-form",{on:{submit:e.handleSave}},[s("b-row",{attrs:{cols:"1","cols-md":"2"}},[s("b-col",{staticClass:"mb-2"},[s("BaseInput",{attrs:{placeholder:"First name",required:"",errorMsg:e.$userErrorMsg("first_name")},model:{value:e.user.first_name,callback:function(s){e.$set(e.user,"first_name",s)},expression:"user.first_name"}})],1),s("b-col",{staticClass:"mb-2"},[s("BaseInput",{attrs:{placeholder:"Last name",required:"",errorMsg:e.$userErrorMsg("last_name")},model:{value:e.user.last_name,callback:function(s){e.$set(e.user,"last_name",s)},expression:"user.last_name"}})],1),s("b-col",{staticClass:"mb-2"},[s("BaseInput",{attrs:{placeholder:"Username",required:"",errorMsg:e.$userErrorMsg("username")},model:{value:e.user.username,callback:function(s){e.$set(e.user,"username",s)},expression:"user.username"}})],1),s("b-col",{staticClass:"mb-2"},[s("BaseInput",{attrs:{type:"email",placeholder:"Email",required:"",errorMsg:e.$userErrorMsg("email")},model:{value:e.user.email,callback:function(s){e.$set(e.user,"email",s)},expression:"user.email"}})],1),s("b-col",{staticClass:"mb-2"},[s("base-input",{attrs:{placeholder:"Password",help:e.isUpdate?"Leave it empty if you don't need to change it":"",type:e.passwordType,required:!e.isUpdate,errorMsg:e.$userErrorMsg("password")},model:{value:e.user.password,callback:function(s){e.$set(e.user,"password",s)},expression:"user.password"}},[s("span",{staticClass:"password_toggler",attrs:{role:"button"},on:{click:e.togglePasswordType}},[e.isPasswordShow?s("span",[s("BIconEyeSlash")],1):s("span",[s("BIconEye")],1)])])],1)],1),s("input",{attrs:{type:"submit",hidden:""}})],1)],1)])},c=[],h=t(6611),m=t(5008),p=t(403),f=t(3339),g=t(4951),y=t(5795),b=t(3822),$={components:{DefaultModal:h.Z,BIconEye:d.unT,BIconEyeSlash:d.qa2,BaseInput:m.Z},mixins:[g.oE,(0,f.Z)("user"),(0,p.Z)()],data:()=>({user:{first_name:"",last_name:"",username:"",email:"",password:""},isBusy:!1,modalSettings:{stayOpen:!1,showStayOpenBtn:!0}}),validations:{user:{first_name:{required:y.C1,minLength:(0,y.Ei)(3),maxLength:(0,y.BS)(54)},last_name:{required:y.C1,minLength:(0,y.Ei)(3),maxLength:(0,y.BS)(54)},username:{required:y.C1,minLength:(0,y.Ei)(3),maxLength:(0,y.BS)(54)},email:{required:y.C1,email:y.Do},password:{required:(0,y.CF)((function(){return!this.isUpdate})),minLength:(0,y.Ei)(8),maxLength:(0,y.BS)(54)}}},computed:{...(0,b.rn)({oldUser:e=>e.dashboard.users.one}),isUpdate(){return!!this.oldUser.id},formTitle(){return this.isUpdate?"Edit User":"Create User"}},methods:{...(0,b.nv)(["createUser","updateUser"]),show(){if(this.isUpdate){for(let e in this.user)"password"!=e&&(this.user[e]=this.oldUser[e]||"");this.user.id=this.oldUser.id,this.modalSettings.showStayOpenBtn=!1}else this.resetForm(),this.modalSettings.showStayOpenBtn=!0;setTimeout((()=>{this.$refs?.inputName?.$children[0]?.$children[0]?.focus()}),300)},async handleSave(e){if(e.preventDefault(),this.$v.$touch(),!this.$v.user.$invalid){this.isBusy=!0;try{let e=this.isUpdate?this.updateUser:this.createUser,s=JSON.parse(JSON.stringify(this.user));this.isUpdate&&!s.password&&delete s.password,await e(this.user);let t=`User has been ${this.isUpdate?"updated":"created"} successfully`;if(this.$fireMessage({message:t}),this.resetForm(),!this.modalSettings.showStayOpenBtn||!this.modalSettings.stayOpen)return this.$bvModal.hide("UserFormModal");this.$refs?.inputName?.$children[0]?.$children[0]?.focus()}catch(s){this.$setUserErrors(s.errors)}finally{this.isBusy=!1}}},resetForm(){for(let e in this.user)this.user[e]="";this.$store.commit("SET_ONE_USER",{}),this.$resetUserErrors(),this.$nextTick(this.$v.$reset)}}},U=$,w=t(1001),v=(0,w.Z)(U,u,c,!1,null,null,null),S=v.exports,_=t(6614),k={name:"UsersView",components:{DashboardContent:i.Z,BaseDropdownSelect:n.Z,BaseCheckbox:o.Z,BIconPencilSquare:d.Sle,BIconTrash:d.DkS,BasePagination:l.Z,UserFormModal:S,DeleteModal:_.Z},data(){return{fields:[{key:"#",tdClass:"text-md-center",thClass:"text-md-center"},{key:"username"},{key:"full_name"},{key:"email"},{key:"is_active"},{key:"created_at"},{key:"actions"}],statusOptions:[{name:"Any Status",id:""},{name:"Active",id:"active"},{name:"Not Active",id:"not_active"}],filters:{status:""},perPage:10,page:1,isLoading:!1}},mounted(){this.getUsers(),this.$store.dispatch("getUsers","?type=options").then((e=>this.$store.commit("SET_USER_OPTIONS",e)))},watch:{filters:{handler(){this.page=1,this.getUsers()},deep:!0},perPage(){this.getUsers()},page(){this.getUsers()}},methods:{getUsers(){return this.isLoading=!0,this.$store.dispatch("getUsers",`?per_page=${this.perPage}&page=${this.page}&status=${this.filters.status}`).finally((()=>this.isLoading=!1))},openEditModal(e){this.$store.commit("SET_ONE_USER",e),this.$nextTick((()=>{this.$bvModal.show("UserFormModal")}))},async changeStatus(e,s){s.is_active=e;try{await this.$store.dispatch("changeUserStatus",s),this.$fireMessage()}catch(t){this.$fireMessage({type:"danger"})}},async deleteUser(e){try{this.$refs.DeleteUserModal.setBusy(!0),await this.$store.dispatch("deleteUser",e),this.$fireMessage({message:"Deleted Successfully"})}catch(s){this.$fireMessage({type:"danger"})}finally{this.$refs.DeleteUserModal.close()}}}},B=k,M=(0,w.Z)(B,a,r,!1,null,null,null),x=M.exports},403:function(e,s,t){function a(...e){e.length||(e=["password"]);let s={},t={},a={};for(let r of e){let e=r+"Type";s[e]="password";let i=r.slice(0,1).toUpperCase()+r.slice(1),n="toggle"+i+"Type";t[n]=function(){this[e]="password"==this[e]?"text":"password"},a["is"+i+"Show"]=function(){return"text"==this[e]}}return{data(){return s},computed:a,methods:t}}t.d(s,{Z:function(){return a}})}}]);